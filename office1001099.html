<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">

<!--2026/02/10 17:56:25-->

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <meta http-equiv="Content-Script-Type" content="text/javascript">
  <meta name="GENERATOR" content="ホームページV4">
  <title>Miniscope recording - Kitaya lab</title>
  <link rel="stylesheet" href="02_white_a0_0010.css" type="text/css" media="all">
</head>

<body>
  <div id="page">
  <div id="header">operanthouseのヘッダー</div>
  <div id="title">
  <h1>Kitaya lab</h1></div>
  <div id="menubar"><div class="mainmenu"><ul><li class="mainmenulistitem"><span class="mainmenuitem"><span class="mainmenuitemright"><span class="mainmenuitemcenter"><a href="index.html" class="mainmenuitemlink"><span class="mainmenuitemmark">オペラントハウスとは</span></a></span></span></span></li><li class="mainmenulistitem"><span class="mainmenuitem"><span class="mainmenuitemright"><span class="mainmenuitemcenter"><a href="office1001038.html" class="mainmenuitemlink"><span class="mainmenuitemmark">What's Operant House?</span></a></span></span></span></li><li class="mainmenulistitem"><span class="mainmenuitem"><span class="mainmenuitemright"><span class="mainmenuitemcenter"><a href="profile1.html" class="mainmenuitemlink"><span class="mainmenuitemmark">行動解析君とは?</span></a></span></span></span></li><li class="mainmenulistitem"><span class="mainmenuitem"><span class="mainmenuitemright"><span class="mainmenuitemcenter"><a href="profile1076.html" class="mainmenuitemlink"><span class="mainmenuitemmark">Mr. Behavio?</span></a></span></span></span></li><li class="mainmenulistitem"><span class="mainmenuitem"><span class="mainmenuitemright"><span class="mainmenuitemcenter"><a href="profile1001.html" class="mainmenuitemlink"><span class="mainmenuitemmark">Gait analyzer</span></a></span></span></span></li><li class="mainmenulistitem"><span class="mainmenuitem"><span class="mainmenuitemright"><span class="mainmenuitemcenter"><a href="privacy1.html" class="mainmenuitemlink"><span class="mainmenuitemmark">プライバシーポリシー</span></a></span></span></span></li></ul>
</div></div>
  <div id="side1">
  <div class="submenu"><ul><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001038.html" class="submenuitemlink"><span class="submenuitemmark1">What's Operant House?</span></a></span></span></span></li><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001039.html" class="submenuitemlink"><span class="submenuitemmark1">Preparation(Download)</span></a></span></span></span></li><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="99_blank004.html" class="submenuitemlink"><span class="submenuitemmark1">Production of the OperantHouse</span></a></span></span></span></li><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="99_blank005.html" class="submenuitemlink"><span class="submenuitemmark1">About Option Parts</span></a></span></span></span></li><li><span class="submenuitem" style="margin-left:10px;"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001051.html" class="submenuitemlink"><span class="submenuitemmark2">IR Camera Detaction</span></a></span></span></span></li><li><span class="submenuitem" style="margin-left:10px;"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001052.html" class="submenuitemlink"><span class="submenuitemmark2">Lever Module</span></a></span></span></span></li><li><span class="submenuitem" style="margin-left:10px;"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001053.html" class="submenuitemlink"><span class="submenuitemmark2">IR Sensor Bar</span></a></span></span></span></li><li><span class="submenuitem" style="margin-left:10px;"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001054.html" class="submenuitemlink"><span class="submenuitemmark2">Additional Operation Monitor</span></a></span></span></span></li><li><span class="submenuitem" style="margin-left:10px;"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001099.html" class="submenuitemlink"><span class="submenuitemmark2">Miniscope recording</span></a></span></span></span></li><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001055.html" class="submenuitemlink"><span class="submenuitemmark1">Handling of OperantHouse</span></a></span></span></span></li><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="99_blank006.html" class="submenuitemlink"><span class="submenuitemmark1">Custom task</span></a></span></span></span></li><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001072.html" class="submenuitemlink"><span class="submenuitemmark1">Command list</span></a></span></span></span></li><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001073.html" class="submenuitemlink"><span class="submenuitemmark1">Default tasks</span></a></span></span></span></li><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001063.html" class="submenuitemlink"><span class="submenuitemmark1">Tips</span></a></span></span></span></li><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001064.html" class="submenuitemlink"><span class="submenuitemmark1">Troubleshooting</span></a></span></span></span></li><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001102.html" class="submenuitemlink"><span class="submenuitemmark1">Copyright</span></a></span></span></span></li><li><span class="submenuitem"><span class="submenuitemright"><span class="submenuitemcenter"><a href="office1001071.html" class="submenuitemlink"><span class="submenuitemmark1">日本語ページへ</span></a></span></span></span></li></ul>
</div></div>
  <div id="side2"></div>
  <div id="main_wrapper000" class="HPZAutoMarginAdjuster">
  <div id="main">
  <h1>Miniscope recording</h1>
  <hr>
  <br clear="all">
  <br clear="all">
  <h2>Overview</h2>
  The Operant House has a module to perform in vivo imaging with UCLA miniscope v4. For the temporal synchronization, both software of Operant House and miniscope are run in the Windows computer. We have tested with windows 10 but it should be compatible with Windows11. To remove the cable twisting during the analysis, a slip ring is installed on the roof.<br clear="all">
  <h4><img src="paste342.jpg" alt="" border="0"></h4>
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <h2>Required materials</h2>
  <br clear="all">
  - UV-curable adhesive or epoxy-based glue<br clear="all">
  <br clear="all">
  - HDMI (male) to DisplayPort (male) cable (This is necessary if your computer only supports DisplayPort output)<br clear="all">
  <h2><br class="HPZAutoBR"></h2>
  <h2><br class="HPZAutoBR"></h2>
  <h2><br class="HPZAutoBR"></h2>
  <h2><br class="HPZAutoBR"></h2>
  <h2>Slip Ring Assembly</h2>
  <br clear="all">
  <b>&lt;Wire preparation&gt;</b><br clear="all">
  We first create the wiring that connects the Miniscope to the DAQ board via the slip ring (referred to as Cable ①).<br clear="all">
  Cut a 22 cm segment of COONER WIRE's CW2040-3650 SR coaxial wire.<br clear="all">
  <br clear="all">
  <img src="paste3462.jpg" alt="" height="342" width="332" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Coaxial cables have a structure in which the negative (ground) wire surrounds the positive (signal) wire, providing electromagnetic shielding.<br clear="all">
  <img src="paste346.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Strip the outer insulation.<br clear="all">
  <img src="paste349.jpg" alt="" height="123" width="220" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Carefully untwist the shielding fibers (ground).<br clear="all">
  <img src="paste348.jpg" alt="" height="114" width="219" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Isolate the inner insulated wire (positive).<br clear="all">
  Twist and bundle the ground fibers<br clear="all">
  <img src="paste350.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Strip the insulation from the tip of the positive wire using nippers (Make a small scratch and then peel it back).<br clear="all">
  Magnifying glass or stereomicroscope make this process easier.<br clear="all">
  <img src="paste3512.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  &lt;Soldering the Hirose Connector (Female)&gt;<br clear="all">
  <br clear="all">
  Using of magnification is strongly recommended for this soldering because it make the process much easier.<br clear="all">
  Secure the Hirose connector (female) on the table with double-sided tape.<br clear="all">
  The small pin in the connector circled in red is the positibe terminal.<br clear="all">
  <img src="paste35313.jpg" alt="" height="184" width="220" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Use the flexible arm to position the cable precisely then perform soldering. After the soldering, test for shorts using a multimater.<img src="paste354.jpg" alt="" height="283" width="426" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Reinforce the solder joints using UV-curable adhesive or epoxy. Keep the connector face upwards to avoid adhesive leakage into contact points. UV-curing adhensive is recommended because they harden instantly.<br clear="all">
  <img src="paste3641.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <b>&lt;Preparing the Slip Ring (Adafruit 775)&gt;</b><br clear="all">
  <br clear="all">
  The principle of the slip ring is as follows: inside, there is a rotating conductive drum (blue) and electrodes (red) that remain in contact with it. When the drum rotates, the electrodes stay in contact, thereby maintaining the electrical connection.<br clear="all">
  <img src="paste355.jpg" alt="" height="142" width="279" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  The slip ring to be used is the <b>775 model (Adafruit Industries)</b>. The rotational resistance of it's shaft is too high for use in mouse experiment, threfore we will modify it to ensure smooth rotation. <br clear="all">
  775 has six lines, and each line is connected by two electrodes, meaning a total of twelve electrodes are rubbing against the drum. <br clear="all">
  Miniscope only requires two lines and the remaining four lines are unnecessary so we will remove those unnecessary lines.<br clear="all">
  <br clear="all">
  Cut off any escess length of wiring.<br clear="all">
  <img src="paste356.jpg" alt="" height="170" width="418" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Remove the plastic cover. You should see a gap between the cover and body part (arrows). Insert the nippers into this gap and break the cover apart.<br clear="all">
  <img src="paste362.jpg" alt="" height="208" width="152" border="0">　　<img src="paste3581.jpg" alt="" border="0">　　<br clear="all">
  <br clear="all">
  <img src="paste360.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <img src="paste361.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <img src="paste352.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <img src="paste357.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Disassemble the slip ring body. The drum will come off when lifted.<br clear="all">
  You should see three paris of electrodes standing upright. Each pair corresponds to one line.<br clear="all">
  Remove the electrode pairs circuled in red.<br clear="all">
  <img src="paste3591.jpg" alt="" height="215" width="439" border="0"><br clear="all">
  <img src="paste3631.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Bend the electrodes outward so they do not touch the drum. Be caful not to touch the center line!<br clear="all">
  <img src="paste366.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Once the work is complete, reassemble it and secure it with tape.<br clear="all">
  Check wheter the rotational resistance has decreased enough for the mouse experiment.<br clear="all">
  <img src="paste358.jpg" alt="" height="296" width="491" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  &lt;Connection of the Slip Ring&gt;<br clear="all">
  Strip the insulations from the other side of the coaxial cable using the same precedure as before to expose them. Then solder it to the slip ring cables. Check that thre is no short circuit.<br clear="all">
  <img src="paste359.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Reinforce the joint part with adhensive.<br clear="all">
  <img src="paste363.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <b>&lt;Cable wiring between Srip Ring and DAQ board&gt;</b><br clear="all">
  Cut the coaxial cable to a length of 20 cm and strop both ends.<br clear="all">
  <img src="paste3754.jpg" alt="" height="340" width="490" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Solder it to the slip ring and reinforce with with adhensive.<br clear="all">
  <img src="paste365.jpg" alt="" border="0"><br clear="all">
  <img src="paste367.jpg" alt="" height="276" width="441" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Add 6mm heat shrink tubing to prevent stress from concentrating at this location.<br clear="all">
  <img src="paste373.jpg" alt="" height="188" width="271" border="0"><img src="paste368.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Solder the opposite side of the coaxial cable to the SMA connector. After confirming there is no short, apply adhensive and fit the heat shrink tubing. Since the heat shrink tubing cannot be inserted after soldering, thread it into the wire beforehand.<img src="paste370.jpg" alt="" height="216" width="617" border="0"><br clear="all">
  <br clear="all">
  <img src="paste369.jpg" alt="" height="229" width="617" border="0"><br clear="all">
  <br clear="all">
  <img src="paste340.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Once the Hirose connector is connected to your miniscope, the slip ring preparation is complete.<br clear="all">
  <img src="paste351.jpg" alt="" height="606" width="771" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <h2>【Fabrication of holders for slip ring and DAQ board】</h2>
  <br clear="all">
  Find the STL file in the Option parts/Miniscope folder and print them.<br clear="all">
  <br clear="all">
  - Commutator holder.stl<br clear="all">
  - DAQ holder.stl<br clear="all">
  <br clear="all">
  Left: slip ring adapter. Right: DAQ holder.<br clear="all">
  <img src="paste338.jpg" alt="" height="259" width="290" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Attach these slots to the OperantHouse lid. The locations varies depend on the nosepoke detection setting.<br clear="all">
  <br clear="all">
  [When using camera for the touch detection (Default)]<br clear="all">
  <img src="paste3532.jpg" alt="" height="323" width="418" border="0"><br clear="all">
  <br clear="all">
  [When using IR sensor bar for the touch detection]<br clear="all">
  <img src="paste3751.jpg" alt="" height="281" width="417" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Here, I will explain with the lid for the IR sensor bar setting.<br clear="all">
  <br clear="all">
  Fit the slip ring into the adapter.<br clear="all">
  <img src="paste374.jpg" alt="" height="313" width="273" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Secure the slir ring adapter and DAQ holder with 2mm short screws.<br clear="all">
  <img src="paste3752.jpg" alt="" height="318" width="488" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Fit the DAQ board.<br clear="all">
  <img src="paste376.jpg" alt="" height="308" width="489" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <h2>【Windows PC preparation and connection】</h2>
  <br clear="all">
  <br clear="all">
  Prepare the Windows PC (Higher performance is better).<br clear="all">
  Download the <b>Distribution Installer</b> from the Anaconda website (https://www.anaconda.com/download) and install it.<br clear="all">
  <br clear="all">
  Since Operant House requires several plugins to be installed, set up a virtual environment to avoid contaminating your original Python installation.<br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  [Set up the python virtual environment]<br clear="all">
  Launch the Anaconda Prompt.<br clear="all">
  <br clear="all">
  Type the following to create a virtual environment named OperaEnv.<br clear="all">
  <img src="paste377.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  Turn on the environment you created.<br clear="all">
  <img src="paste378.jpg" alt="" border="0"><br clear="all">
  This will make OperaEnv the default environment for running Python program. This virtual environment data would be stored in<br clear="all">
  <b>C:/Users/[user name]/.conda/envs</b><br clear="all">
  <br clear="all">
  <br clear="all">
  Next, install the plugins. <br clear="all">
  Install OpenCV for capturing the USB camera.<br clear="all">
  <img src="paste382.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  Install pyserial for serial communication with the Arduino.<br clear="all">
  <img src="paste383.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  Install win32api.<br clear="all">
  <img src="paste353.jpg" alt="" height="27" width="454" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  [Modify the code of the Operan House]<br clear="all">
  The next step will change the code Operant House code for computer use. Open the Operant House code in Notepad and set the value of <b>RaspberryMode</b> in general setting to <b>0</b>.<br clear="all">
  <img src="paste3533.jpg" alt="" height="102" width="771" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  To change the operation computer from the Raspberry Pi to the Windows PC, disconnect the USB connection between Arduino-Raspberry Pi and connect between Arduino-Windows PC. Also connect the USB camera to the Windows PC. If you are using an infrared sensor board, connect that to the PC as well.<br clear="all">
  <br clear="all">
  Next, check which port your PC recognized the Arduino on. Open Device Manager from the Control Panel.<br clear="all">
  <img src="paste3753.jpg" alt="" border="0"><br clear="all">
  The port numbers are hilighted in red. The <b>USB Serial Device (COM6)</b> listed here is your Arduino. If you're unsure which one it is, unplug the USB cable from your Arduino and see which number disappers. This number can varied depend on your computer.<br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Next, check the port number configured in Operant House. In this example, the port number is set to <b>COM3</b>.<br clear="all">
  <img src="paste3811.jpg" alt="" height="201" width="809" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Fix the number from <b>COM3</b> to <b>COM6</b> to make the Operant House program to recognize the Arduino connected.<br clear="all">
  <img src="paste386.jpg" alt="" height="188" width="809" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  If you are using a laptop computer with a built-in camera, deactivate it in Device Manager.<br clear="all">
  <img src="paste3755.jpg" alt="" height="296" width="356" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  [Configuration of the miniscope capturing software]<br clear="all">
  <br clear="all">
  In this recording, Miniscope software does not need to capture the behavior camera, you must modify the configure file to turn off the behavior camera capturing on the Miniscope softwre.<br clear="all">
  Open the Miniscope config file (UserConfigExample-V4-Miniscope-plus-WebCam.json) in notepad and delete the <b>cameras</b> section highlighted in red.<br clear="all">
  <img src="paste37911.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  After deletion, it should look like this.<img src="paste380.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  All prepartaions are now complete.<br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  &lt;Launch of the software for the experiment&gt;<br clear="all">
  Launch the Anaconda.<br clear="all">
  Activate <b>OperaEnv</b> in Anaconda, then use cd command to change the current directly to the Operant House folder (the path varied by environment).<br clear="all">
  <img src="paste381.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Next use the <b>python</b> command to execute the Operant House code (the python file name in the following example can be different from your case because this file name will change by version up).<br clear="all">
  <img src="paste384.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Once Operant House proram is running, launch the Miniscope software and check if Miniscope images are captured without frame drop (Frame drops at the launch of the program can be ignored).<br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  &lt;If the captured image is not displayed&gt;<br clear="all">
  The camera ID setting may be incorrect (currently, Operant House's camera is set to 0 and Miniscope's camera ID is set to 1). Swap the camera IDs using the following procedure.<br clear="all">
  <br clear="all">
  Change the ID of behavior camera in Operant House's source code to 1.　　　　<img src="paste3771.jpg" alt="" height="226" width="809" border="0"><br clear="all">
  <br clear="all">
  Change the camera ID of the miniscope in the miniscope config file to &quot;0&quot;.<br clear="all">
  <img src="paste3782.jpg" alt="" border="0"><br clear="all">
  <i>The camera ID assignments are generally consistent for the same connection pattern, but there is still a chance they change. If issue occur, try swapping the camera ID by theway showen here.</i><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  If the captures work with both software and Operant House software runs at 30 fps and there is no increase in frame drops after startup, the recording is ready.<br clear="all">
  <br clear="all">
  Start capturing with Miniscope, then click the <b>start</b> button on the Operant House software to start the task manually (Don't forget to set save folder path before this). Both software use the same Windows clock for their timestamps, so synchronization via TTL signal is not necessary.<br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <h2>【Infrared Sensor Bar Reference (Only if using the infrared sensor bar)】</h2>
  If you are detecting panel touch with a camera, please skip this section.<br clear="all">
  This explanation assumes that you already have experience using an infrared sensor bar with a Raspberry Pi. If you do not have such experience, please read <b>About Option Part→ Miniscope IR Sensor Bar</b> in the left menu beforehand.<br clear="all">
  <br clear="all">
  <br clear="all">
  Connect the monitor (for panel display), Arduino, ceiling camera and infrared sensor bar to the Windows computer.<br clear="all">
  Right-click on the blank desktop to open <b>Display settings</b> and set the touch monitor as an extended display to the right of the main monitor.<br clear="all">
  <img src="paste3643.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  Basically, we can use IR sensor bar in the same manner as we use it with Raspberry Pi, howver, on Windows11, the mouse pointer moves within the area on the right side of the computer's main screen by unkown reason. This area will be reffered as <b>&quot;Sensor bar area&quot;</b>.<br clear="all">
  <img src="paste379.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  As it stands, the subject animal can touch the Windows taskbar through the IR sensor bar and can cause a trouble. To prevent this, move the taskbar to the left side of the screen. Unfortunately, Windows11 does not have the function to move it by default so download <b>StartAllBack</b> in the Microsoft Store to change the interface of Windows 11 to Windows 10 style layout in which taskbar is movable.<br clear="all">
  <img src="paste385.jpg" alt="" height="382" width="426" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  After installation, the desktop should immediately switch to a Windows 10-style appearance.<br clear="all">
  <img src="paste387.jpg" alt="" border="0"><br clear="all">
  <i>You'll see the start button on the left after the installation.</i><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Then right-click the taskbar and select <b>Properties</b>.<br clear="all">
  <img src="paste388.jpg" alt="" height="156" width="284" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Set taskbar location on screen to <b>Left</b>.<br clear="all">
  <img src="paste3901.jpg" alt="" height="397" width="584" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  The taskbar should be located on the left. Please note that <b>StartAllBack</b> can be used free for the first 100 days, but after that it requires a paid license (As of September 22 2025, it is available as a one-time purchase for $7).<br clear="all">
  <img src="paste3961.jpg" alt="" height="291" width="369" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  If the taskbar is displayed on the touch monitor, right-click the taskbar to open <b>Taskbar settings</b> → <b>Taskbar behaviors</b> and uncheck the <b>Show my taskbar on alldisplays</b> to remove it in the touch monitor.<br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  The infrared sensor bar is recognized by Windows as a <b>Pen/Touch device</b>. Because of this, a long press is interpreted as a right-click and mouse can touch the right-click menu. To avoid this, let's desable this feature.<br clear="all">
  <br clear="all">
  <br clear="all">
  Open <b>Control Panel</b>→<b>Pen and Touch</b>, select <b>Press and hold</b>, click <b>Settings</b>, and uncheck <b>Enable press and hold for right-clicking</b>.<br clear="all">
  (The <b>Pen and Touch</b> will appear only when the IR sensor bar is connected)<br clear="all">
  <img src="paste3756.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <img src="paste3642.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <img src="paste3902.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Next, cover the <b>sensor bar area</b> with touch window. This prevents a deactivation the touch windows that cause stopping of the tracking of the mouse corsor position by the Operant House program by panel touching of the subject animal.<br clear="all">
  <br clear="all">
  <br clear="all">
  Please look to the <b>General setting</b> section in the Operant House code.<br clear="all">
  <img src="paste36431.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  If you set the <b>OperationMonitorWidth</b>value smaller than the actual computer's monitor size, the touch window will move to the left and extend beyond the Operation monitor as below desktop screen shot. Increasing the <b>OperationMonitorHeight</b>value will extend the touch window downward. Adjust these values so that the touch window fully covers the Sensor bar area.<br clear="all">
  <img src="paste3758.jpg" alt="" height="272" width="831" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  When the touch window shifts to the left, it would leave empty space on the right side of the touch monitor. To cover this gap, increase the value of <b>TouchMonitorWidth</b>.<br clear="all">
  <img src="paste3757.jpg" alt="" height="364" width="335" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Once you have completed these steps, the desktop should appear as shown below.<br clear="all">
  <img src="paste375.jpg" alt="" height="272" width="831" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Next, calibrate the touch point reference. As this stage, the orange dot does not appear under your finger when you touch the monitor due to different coordinate system between Windows and the Raspberry Pi. To fix it, launch Operant House software and click the <b>Setting</b> button on the left of the Main window. Adjust the parameters indicated by the red rectangle. The adjustment method is the same as described in <b>About Optional Parts → IR Sensor Bar</b>in the left menu when using Raspberry Pi.<br clear="all">
  I recommend to change <b>TouchOffsets</b> first to shift the orange dot. Increasing the X and Y values move the dot to the right and upward, respectively. When the dot appears in the touch window, adjust <b>TouchRatio</b>. If the dot moves faster than your finger when your finger moves on the monitor surface, lower the <b>TouchRatio</b> ratio and <i>vise visa</i>.<br clear="all">
  <img src="paste3891.jpg" alt="" border="0"><br clear="all">
  <br clear="all">
  <br clear="all">
  When the dot follows your finger precisely, the adjustment is complete.<br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  Finally, adjust the panel positions on each task. The procedure is the same as on the Raspberry Pi (see the <b>Handling of OperantHouse</b> in the left menu).<br clear="all">
  Once the panel alignment is finished, the infrared sensor bar calibration is complete.<br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <br clear="all">
  <h2>【Test】</h2>
  After connecting miniscope, start capture with <b>Miniscope software</b>, then manually start the task (use the <b>Start</b> button) in the Operant House software. If the frame rates are not dropped in both software, the preparation for recording with Miniscope is finished. </div>
  </div>
  <div id="footer">operanthouseのフッター</div>
  <div id="HPZLPPageTail" style="clear: both;"></div></div>
</body>

</html>
